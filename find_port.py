# find_port.py
import socket

def find_free_port():
    """
    –ù–∞—Ö–æ–¥–∏—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π TCP –ø–æ—Ä—Ç, –¥–æ—Å—Ç—É–ø–Ω—ã–π –≤ —Å–∏—Å—Ç–µ–º–µ.
    """
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        # –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–∫–µ—Ç –∫ –ø–æ—Ä—Ç—É 0. –û–° —Å–∞–º–∞ –≤—ã–¥–µ–ª–∏—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞.
        s.bind(('', 0))
        # –£–∑–Ω–∞–µ–º, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –ø–æ—Ä—Ç –±—ã–ª –≤—ã–¥–µ–ª–µ–Ω, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ.
        return s.getsockname()[1]

if __name__ == "__main__":
    port = find_free_port()
    print(f"‚úÖ –°–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç –Ω–∞–π–¥–µ–Ω: {port}")
    print(f"üëâ –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ uvicorn: uvicorn webapp:app --host 0.0.0.0 --port {port}")
